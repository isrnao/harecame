Harecame（ハレカメ）PoC プロダクト要件書

背景・概要

**Harecame（ハレカメ）は、地域の運動会やスポーツ大会など「ハレの日」に、保護者や関係者が自分のスマホをカメラとして手軽に参加できるライブ配信サービスです.Harecameは「スマホがあれば誰でもカメラマン」**になれる参加型サービスとして、簡単・低コストに複数視点からのライブ中継を実現し、遠隔地の家族や友人がリアルタイム及びオンデマンドで大切なイベントを視聴できることを目指します。スマートフォンとインターネット環境さえあれば特別な機材不要でライブ配信できるため、行事オンライン配信ニーズにも応えることができます。YouTubeの限定公開機能を活用してプライバシーを確保しつつ、ライブ配信後はアーカイブ映像として保存・共有することでオンデマンド視聴にも対応します。

提供価値・サービスの特徴

Harecameがユーザーにもたらす価値と、競合サービスと比較した特徴をまとめます。

簡単さ最優先の設計: スマホで撮影開始ボタンを押すだけで配信に参加できるシンプルさを追求します。撮影者側の事前登録や難しい認証手順は極力省き、誰でも思い立ったらすぐカメラマンになれる体験を提供します（URLリンクやQRコードからワンクリック参加を想定）。 

クラウド上での自動映像スイッチング: サーバ側で複数入力映像を管理し、「後から参加したカメラ映像に自動で切替」するシステムを実装します。誰か一人が配信中でも新たなカメラが撮影を開始したら、直ちにその映像をYouTube配信に切り替える仕様です（＝最後に参加したカメラを優先）。このルールにより、難しい操作なしにリアルタイムで撮影者リレーが可能になります。例えば運動会で父兄Aさんが徒競走のスタートを撮影後、ゴール地点のBさんが後から配信開始すれば、自動的にゴール映像に切り替わるイメージです。切替の瞬間はシンプルにカット遷移とし、複雑なトランジション演出はPoC段階では省略します。 

低コストかつ手軽な配信インフラ: YouTube Live（限定公開）を配信先とすることで、専用の視聴インフラ構築を避け信頼性とコスト低減を両立します。YouTube上でアーカイブも自動保存されるため、オンデマンド視聴にも追加開発なしで対応できます。サービス利用料はPoC期間中は完全無料とし、将来的にも競合のような手頃な価格設定（参考: CaMEは2時間935円～）または学校等へのサブスクリプションモデルを検討します。無料で試せる間口を広く取ることで、多くのユーザーにまず使ってもらいフィードバックを得るのが狙いです。 

参加型サービスならではの双方向性: 単なる映像配信に留まらず、視聴者はチャットを通じてコメントや応援メッセージを送ることができます（PoCではYouTubeのライブチャット機能を利用予定）。撮影者も配信を見返せるようにすることで、「自分が子供の活躍シーンを配信で届けた」という満足感や共有体験を提供します。将来的には視聴者がいいねやスタンプでリアクションできる機能、撮影者同士が簡単に役割調整できる機能など、参加型ならではの拡張も検討します。 

以上のように、Harecameは**「誰でも・どこでも・みんなで作るライブ中継」**をキーワードに、小規模イベントに新しい価値を提供します。

機能要件（PoC範囲）

PoC（概念実証）段階では、コアとなる機能に絞ってシステムを実装します。1ヶ月という短い開発期間で確実に動作する最低限のプロダクトを構築し、実際のイベントで試用することを目標とします。以下にPoCで実現する機能要件をまとめます。

イベント作成と視聴URL発行:  管理者（イベント主催者）はシステム上でイベントを作成し、視聴用のYouTube Live配信URLまたは埋め込みページを準備します。イベント名・日時などの基本情報を登録し、関係者へ配信URLを共有できるようにします。PoCでは認証機能を簡略化するため、イベント作成はシステム管理者が直接設定するか、固定のイベントとして実装します（一般ユーザーによる自由なイベント登録機能は省略）。 

撮影者（カメラマン）参加機能:  誰でも撮影者としてライブ映像を送信できるよう、シンプルな撮影開始UIを提供します。具体的には、撮影用のWebページにアクセスし、「カメラ起動・配信開始」ボタン一つで映像ストリームをクラウドに送信できるようにします。事前のユーザー登録やログインは不要とし、配信に参加するための簡易な手段（例えばイベント固有の参加コード入力やQRコードスキャン）で撮影セッションを開始可能にします。カメラ映像の解像度はモバイル回線負荷も考慮し720p程度を目安に、遅延はできるだけ小さく（数秒以内）保つことを目指します。 

マルチカメラ映像のクラウド集約・管理:  バックエンドのメディアサーバ（後述するLiveKit）上で複数の入力映像を受け取り、現在アクティブな映像を選択します。他のカメラ映像がまだ配信中の場合でも、新たな映像入力が開始されたら自動的にそちらをアクティブに切り替えます（基本ルール：「後勝ち優先」）。同時に複数人が配信を開始した場合、後からボタンを押した人の映像に切り替わります。また、あるカメラの配信が終了した際は、他に待機中の映像がなければビジー状態となりデフォルト画像を配信します（PoC段階では細かな例外処理よりシンプルさを優先）。将来的な発展として、複数映像をサムネイル表示して主映像を手動選択できるUIや、自動ではなく主催者がスイッチング制御するモード等も検討可能ですが、PoCでは実装しません。 

YouTubeライブ配信連携:  クラウドで選択された映像は、リアルタイムでYouTube LiveにRTMP配信されます。メディアサーバからYouTubeにストリームキー等で接続し、限定公開のライブ映像として中継します。YouTubeプラットフォームを利用することで大規模な視聴にも耐える安定配信が実現できます。またYouTubeにログインできる関係者にはライブチャット機能も提供可能です（PoCではYouTube標準のチャットUIを利用）。配信後はYouTube上にアーカイブ動画がそのまま残るため、オンデマンド配信として家族が後から視聴することもできます。プライバシー保護のため配信は**「限定公開」**設定とし、URLを知る人だけが視聴可能にします（必要に応じて後述の専用視聴ページでパスワード保護する運用も検討）。 

視聴者向け機能（チャット・通知）:  視聴者は共有されたYouTubeライブURLから配信を視聴できます。PoC段階では追加のログインなしで視聴できることを重視し、基本的にYouTubeのインターフェース（または埋め込みプレイヤー）をそのまま利用します。視聴者同士や主催者へのチャットとしては、YouTubeライブチャット機能をそのまま使うことで実装コストを削減します。通知機能に関しては、PoCでは簡易な手段に留めます。具体的には、イベント開始時にあらかじめ登録されたメールアドレス宛にお知らせメールを送信したり、主催者がLINE等の既存ツールで視聴者に開始通知を送る運用を想定します。将来的にはウェブプッシュ通知やモバイルアプリのプッシュ通知連携（Firebase Cloud MessagingやOneSignal等のサービス活用）により、自動でリアルタイム通知を行えるようにしますが、PoCでは開発期間優先のため高度な通知機能は実装しません。 

管理・モニタリング機能（最小限）：  PoCではフル機能の管理画面は作らずとも、配信の状態を確認できるシンプルなダッシュボードを用意します。主催者またはシステム管理者向けに、現在接続中のカメラ数・それぞれの映像状態・YouTube配信のオンオフ状態が分かるステータス表示を行います。必要に応じて特定カメラの映像を強制終了する機能や、全体配信を停止するボタンも設置します（例えばイベント終了時に即座に配信を切りたい場合など）。ただし高度なユーザー管理（撮影者の個別認可や視聴者ログイン等）はPoCでは行いません。 

以上がPoCにおける主要機能です。PoCの範囲では**「とにかくシンプルに動くこと」**を重視し、ユーザー認証や細かな権限管理、決済処理などはすべてスコープ外としています。必要最低限のフローで、複数スマホ映像 → クラウドスイッチング → YouTube配信という一連のパイプラインを構築・検証することが最大の目的です。

非機能要件と制約

品質（映像・音声遅延と解像度）: 参加者がスマホから送り出す映像の遅延はできる限り短く抑えます（目標: エンドツーエンドで数秒程度）。ライブ性が重要なスポーツ観戦で違和感のない範囲を目指しつつ、YouTubeへのRTMP中継による遅延（通常2～5秒程度）も考慮します。画質はPoCでは720p/30fps程度とし、スマホの通信環境によっては自動でビットレートを下げる適応も検討します（LiveKit等のWebRTC SFU機能に依存）。 

同時接続数: PoCでは小規模イベント想定のため、同時に接続するスマホカメラは最大3～4台程度を上限とします（同時にそれ以上が配信開始するケースは稀と想定）。視聴者数はYouTubeインフラ上では数百～千人規模でも問題ありませんが、PoCでそこまで集客することはなく身内数十人規模を想定します。メディアサーバは同時数ストリームの転送ができるリソースを割り当て、負荷テストも最小限行います。 

信頼性とエラーハンドリング: 1ヶ月のPoC期間中に開催されるイベント（できれば実際の運動会など）で問題なく動作することが目標です。不測の停止を避けるため、可能な限りシンプルなシステム構成とし、万一カメラ映像が全て途切れた場合にはYouTube側の配信が自動停止しないようダミー映像や待機画面の送出も検討します（PoCでは簡易的に静止画を出す程度）。通信不安定による映像フリーズの場合も、次のカメラ切替でリカバリできるようにします。視聴に関してはYouTubeの稼働率に依存しますが、これまでの実績から高い可用性が見込めます。 

プライバシー・セキュリティ: 学校行事の配信ではプライバシー保護が重要です。配信URLが許可なく拡散しないよう、限定公開URLの厳守と必要に応じたパスワード付き視聴ページを提供します（パスワードはPoCでは固定でハードコードでも可）。また撮影者にもモラルを求め、不適切な映像配信を防ぐための注意喚起を行います。PoC後にはアクセス制限や承認機能の導入も検討しますが、現段階では運用ルールで対応します。 

コストとホスティング: PoCは予算ゼロに近い形で行う方針です。可能な限り無料枠のサービスや自前サーバで賄い、インフラコストを抑えます。後述の通り、フロントエンドはVercelなどの無料ホスティングを利用し、メディアサーバもOSSを小規模VM上に立てるか提供元のトライアル枠を活用します。YouTube利用も無料です。ただし、モバイル通信費（撮影者側）やドメイン費用などの最小限のコストは想定されます。 

技術スタックの検討

PoC実現のために使用する主要な技術スタックとその理由・役割を示します。最新の安定バージョンを使用し、モダンで開発生産性の高い構成とします。

フロントエンド: Next.js 15 (React 19) + TypeScript  モダンなReactフレームワークであるNext.js (ver.15)を採用します。サーバサイドレンダリング(SSR)やルーティングが標準で備わり、開発効率とパフォーマンスに優れます。最新のReact 19と組み合わせることで、並行レンダリングなど最新の機能も利用可能です。TypeScriptで型安全に開発することでバグを減らし、チーム開発の効率も向上させます。ユーザー向けのWebインターフェース（視聴ページ、撮影エントリーページ、簡易ダッシュボードなど）はNext.js上で実装し、Vercel等でホスティングします。 

UIライブラリ: shadcn/ui (Radix UI + Tailwind CSS)  UIコンポーネントにはshadcn/uiを活用します。これはReact + Tailwind CSSベースのコンポーネントコレクションで、洗練されたデザインとアクセシビリティに配慮されたUIパーツを素早く導入できます。フォームやボタン、モーダルなど共通デザインを統一しやすく、PoC期間の短い開発でも見栄えと使いやすさを両立できます。Tailwind CSSにより細かなスタイル調整も容易で、デザイン工数を削減します。Radix UI由来のアクセシブルなコンポーネントは、年配の視聴者にも優しいUI体験につながります。 

バックエンド: Node.js 24 + pnpm (サーバサイドランタイム & パッケージ管理)  サーバサイドのロジック（APIやサーバサイド処理）は最新のNode.js 24で構築します。Node.jsはリアルタイム通信や非同期処理に強く、WebRTC連携などにも相性が良い選択です。パッケージマネージャーにはpnpmを使用します。pnpmは高速かつ効率的な依存管理が可能で、モノレポ構成でもディスクスペースを節約できる利点があります。Next.jsのサーバ機能（API RoutesやEdge Functions）を用いて簡易なREST API/Webhookを実装したり、メディアサーバとの連携、YouTube API呼び出し（配信開始/停止制御など）を行います。なお、パフォーマンス上クリティカルな部分（大量の並列処理等）が出てきた場合はGoなどを併用することも検討しますが、PoCでは基本的にNode/TSで統一します。 

メディアストリーミング: LiveKit (Server: Go, SDK: TypeScript)  複数スマホからの映像を集約し配信する中核には、オープンソースのWebRTCプラットフォームLiveKitを採用します。LiveKitはGo言語製のサーバで高パフォーマンスなSFU (Selective Forwarding Unit) を提供し、TypeScript/JavaScriptクライアントSDKも充実しています。これによりブラウザからのカメラ映像をWebRTC経由で遅延少なくサーバに送信し、サーバ上で必要な映像を選択して中継できます。またLiveKitには「Egress」と呼ばれる機能があり、受信したルームの映像をそのままRTMP出力してYouTube等のサービスに配信することが可能です。この既存機能を活用することで、LiveKitサーバに集約した映像をワンステップでYouTube Liveへ転送できます。LiveKitは自前ホスティングが可能であり、PoCではクラウド上のVM（例: AWS EC2の安価インスタンスやOracle Cloudのフリーティア）にLiveKitサーバをデプロイします。必要に応じて一時的にLiveKit提供のSandbox環境や無料トライアルも検討します。Go製で安定性が高く、実績もあるLiveKitを採用することで映像配信部分の開発負荷を大幅に軽減できます。 

データベース/ストレージ: Supabase  PoCでは複雑なデータ管理は行いませんが、イベント情報や配信URL、簡易なログ程度を保存するためにクラウドDBを利用します。OSSかつホスティング無料枠のあるSupabase（内部はPostgreSQL）を候補とし、Next.jsから直接操作します。認証機能は使わずシンプルにテーブルを読み書きするのみです。映像の録画データについてはYouTube上に保存されるため独自ストレージは不要ですが、将来的に独自に録画ファイルを保存する場合はクラウドストレージ（AWS S3等）も検討します。 

チャット・通知基盤（PoCでは実装しない）:  チャット機能は前述の通りPoCではYouTubeの既存機能に頼るため、独自のリアルタイム通信基盤は構築しません。ただ、将来独自チャットを実装する場合に備えて技術選定を行っておきます。PoC後半で余裕があれば、LiveKitのデータチャンネル機能やSocket.ioを用いて簡易チャットルームを試作することも検討します。通知については、Webブラウザのプッシュ通知を使う場合Firebase Cloud Messaging (FCM) が事実上標準的です。モバイルアプリ展開時にはAPNsやFCMと連携した通知機能を実装します。 

配信プラットフォーム: YouTube Live (限定公開)  ユーザーへの映像配信先としてはYouTube Liveを利用します。YouTubeは大規模配信でも耐えうるCDNとインフラを無料で提供してくれるため、PoC段階では最適です。YouTubeのAPIやストリームキーを使い、LiveKitからのRTMPストリームを接続します。視聴者はYouTube上で再生するだけなので専用アプリ不要で、テレビ画面など様々なデバイスで視聴できる互換性も高いです。限定公開設定により検索に出ないクローズドな配信としつつ、URL共有で手軽にアクセスできるメリットがあります。PoCではYouTube上でのチャンネル準備（おそらく主催者や開発者のテスト用チャンネルを使用）と、ライブ配信の事前有効化設定等も行います。 

以上の技術スタックにより、最新のWeb技術をフル活用しつつ迅速な開発を行います。特にLiveKit＋YouTubeという組み合わせは、低遅延な多元中継と高スケーラビリティな配信を両立する鍵となります。今後サービス拡大時にもスケールしやすい構成をPoC段階から意識して選定しています。
